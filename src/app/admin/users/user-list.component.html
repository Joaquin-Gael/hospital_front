<section class="user-list">
  <div class="user-list__card">
    <div class="user-list__header">
      <h2 class="user-list__title">Gesti√≥n de Usuarios</h2>
      <button class="btn btn--primary" (click)="onAddNew()">Agregar Usuario</button>
    </div>
    <div class="user-list__body">
      <div *ngIf="error" class="user-list__alert alert alert--danger">
        {{ error }}
      </div>
      <div *ngIf="loading" class="user-list__loading">
        <span>Cargando usuarios...</span>
      </div>
      <app-data-table
        *ngIf="!loading && users.length"
        [data]="users"
        [columns]="tableColumns"
        [actions]="[
          { label: 'Ver', icon: 'visibility', callback: onView },
          { label: 'Editar', icon: 'edit', callback: onEdit },
          { label: 'Eliminar', icon: 'delete', callback: onDelete },
          { label: 'Banear', icon: 'block', callback: onBanEvent, condition: (user: UserRead) => user.is_active },
          { label: 'Desbanear', icon: 'check_circle', callback: onUnbanEvent, condition: (user: UserRead) => !user.is_active }
        ]"
      ></app-data-table>
      <div *ngIf="!loading && !users.length" class="user-list__empty">
        No se encontraron usuarios.
      </div>
      <div *ngIf="showForm" class="user-list__form">
        <div class="user-list__form-field">
          <label for="img_profile" class="user-list__label">Imagen de Perfil</label>
          <input
            id="img_profile"
            type="file"
            accept="image/*"
            (change)="onFileSelected($event)"
            class="user-list__input-file"
          />
        </div>
        <app-entity-form
          [fields]="formFields"
          [loading]="formLoading"
          [initialData]="selectedUser"
          [submitLabel]="formMode === 'create' ? 'Crear Usuario' : 'Actualizar Usuario'"
          (formSubmit)="onFormSubmit($event)"
          (formCancel)="onFormCancel()"
        ></app-entity-form>
      </div>
    </div>
  </div>
</section>