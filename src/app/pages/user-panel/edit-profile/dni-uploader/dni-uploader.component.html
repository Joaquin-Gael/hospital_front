<div class="dni-uploader">
  <div class="dni-uploader__header">
    <h2 class="dni-uploader__title">
      <i class="material-icons dni-uploader__title-icon">badge</i>
      Verificación de DNI
    </h2>
    <p class="dni-uploader__description">
      Sube las imágenes del frente y dorso de tu DNI para completar la verificación de identidad.
    </p>
  </div>

  <div class="dni-uploader__content">
    <div class="dni-uploader__container">
      <!-- Zona de frente del DNI -->
      <div class="dni-uploader__section">
        <h4 class="dni-uploader__section-title">Frente del DNI</h4>
        
        <div 
          class="dni-uploader__dropzone"
          [class.dni-uploader__dropzone--dragging]="isDraggingFront"
          [class.dni-uploader__dropzone--error]="frontDni && !frontDni.isValid"
          [class.dni-uploader__dropzone--success]="frontDni && frontDni.isValid"
          (dragover)="onDragOverFront($event)"
          (dragleave)="onDragLeaveFront($event)"
          (drop)="onDropFront($event)"
          (click)="triggerFileInput('front')">
          
          @if (!frontDni) {
            <div class="dni-uploader__dropzone-content">
              <i class="material-icons dni-uploader__icon">upload_file</i>
              <p class="dni-uploader__dropzone-text">
                <strong>Haz clic aquí</strong> o arrastra la imagen del frente
              </p>
              <p class="dni-uploader__dropzone-subtext">
                JPEG o PNG, máximo 5MB
              </p>
            </div>
          } @else {
            <div class="dni-uploader__preview">
              @if (frontDni.isValid && frontDni.preview) {
                <img 
                  [src]="frontDni.preview" 
                  alt="Preview frente DNI"
                  class="dni-uploader__preview-image"
                />
              }
              @if (!frontDni.isValid) {
                <div class="dni-uploader__preview-error">
                  <i class="material-icons dni-uploader__error-icon">warning</i>
                  <p class="dni-uploader__error-text">{{ frontDni.errorMessage }}</p>
                </div>
              }
              <button 
                type="button"
                class="dni-uploader__remove-btn"
                (click)="removeFile('front'); $event.stopPropagation()"
                title="Eliminar imagen">
                <i class="material-icons">close</i>
              </button>
            </div>
          }
        </div>

        <input 
          type="file" 
          id="front-file-input"
          class="dni-uploader__file-input"
          accept=".jpg,.jpeg,.png"
          (change)="onFileSelected($event, 'front')"
        />
      </div>

      <!-- Zona de dorso del DNI -->
      <div class="dni-uploader__section">
        <h4 class="dni-uploader__section-title">Dorso del DNI</h4>
        
        <div 
          class="dni-uploader__dropzone"
          [class.dni-uploader__dropzone--dragging]="isDraggingBack"
          [class.dni-uploader__dropzone--error]="backDni && !backDni.isValid"
          [class.dni-uploader__dropzone--success]="backDni && backDni.isValid"
          (dragover)="onDragOverBack($event)"
          (dragleave)="onDragLeaveBack($event)"
          (drop)="onDropBack($event)"
          (click)="triggerFileInput('back')">
          
          @if (!backDni) {
            <div class="dni-uploader__dropzone-content">
              <i class="material-icons dni-uploader__icon">upload_file</i>
              <p class="dni-uploader__dropzone-text">
                <strong>Haz clic aquí</strong> o arrastra la imagen del dorso
              </p>
              <p class="dni-uploader__dropzone-subtext">
                JPEG o PNG, máximo 5MB
              </p>
            </div>
          } @else {
            <div class="dni-uploader__preview">
              @if (backDni.isValid && backDni.preview) {
                <img 
                  [src]="backDni.preview" 
                  alt="Preview dorso DNI"
                  class="dni-uploader__preview-image"
                />
              }
              @if (!backDni.isValid) {
                <div class="dni-uploader__preview-error">
                  <i class="material-icons dni-uploader__error-icon">warning</i>
                  <p class="dni-uploader__error-text">{{ backDni.errorMessage }}</p>
                </div>
              }
              <button 
                type="button"
                class="dni-uploader__remove-btn"
                (click)="removeFile('back'); $event.stopPropagation()"
                title="Eliminar imagen">
                <i class="material-icons">close</i>
              </button>
            </div>
          }
        </div>

        <input 
          type="file" 
          id="back-file-input"
          class="dni-uploader__file-input"
          accept=".jpg,.jpeg,.png"
          (change)="onFileSelected($event, 'back')"
        />
      </div>
    </div>

    <!-- Botón de envío -->
    <div class="dni-uploader__actions">
      <button 
        type="button"
        class="dni-uploader__submit-btn"
        [class.dni-uploader__submit-btn--disabled]="!canSubmit"
        [disabled]="!canSubmit"
        (click)="onSubmit()">
        @if (isSubmitting) {
          <i class="material-icons">hourglass_top</i>
        } @else {
          <i class="material-icons">cloud_upload</i>
        }
        {{ isSubmitting ? 'Enviando...' : 'Enviar para verificación' }}
      </button>
      
      @if (frontDni?.isValid && backDni?.isValid) {
        <p class="dni-uploader__status">
          <i class="material-icons">check_circle</i>
          Ambas imágenes están listas para enviar
        </p>
      }
      
      @if (!canSubmit && (frontDni || backDni)) {
        <p class="dni-uploader__status dni-uploader__status--warning">
          {{ !frontDni ? 'Falta la imagen del frente' : !backDni ? 'Falta la imagen del dorso' : 'Verifica que las imágenes sean válidas' }}
        </p>
      }
    </div>
  </div>
</div>